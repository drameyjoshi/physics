\documentclass{article}
\usepackage{amsmath, graphicx, xcolor, hyperref}
\usepackage{mathabx}
\include{common}
\begin{document}
\title{The Electric Potential}
\author{Amey Joshi}
\date{15-Jun-2024}
\maketitle
\begin{enumerate}
\item Given that $\vec{E} = 6xy\uv{x} + 3(x^2 - y^2)\uv{y}$. Denote the origin 
$(0,0,0)$ by $O$ and the point $(x_1, y_1, 0)$ by $A$. In the first case,
\begin{equation}\label{e1}
d\vec{s} = \uv{x}dx + \uv{y}dy
\end{equation}
so that the line integral is
\begin{eqnarray}
L_1 &=& \int_O^A\vec{E}\cdot d\vec{s} \nonumber \\
 &=& \int_0^{x_1}3x^2\uv{y}\cdot\uv{x}dx + 
     \int_0^{y_1}(6x_1y\uv{x} + 3(x_1^2 - y^2)\uv{y}dy)\cdot\uv{y}dy \nonumber \\
 &=& 0 + \int_0^{y_1}(x_1^2 - y^2)dy \nonumber \\
 &=& 3x_1^2y - y_1^3 \label{e2}
\end{eqnarray}
In the second case, the equation of the straight line is 
\begin{equation}\label{e3}
y = \frac{y_1}{x_1}x
\end{equation}
so that
\[
dy = \frac{y_1}{x_1}dx
\]
and
\begin{equation}\label{e4}
d\vec{s} = \uv{x}dx + \uv{y}dy = \uv{x}dx + \uv{y}\frac{y_1}{x_1}dx.
\end{equation}
Further, along the straight line,
\begin{equation}\label{e5}
\vec{E} = 6\frac{y_1}{x_1}x^2\uv{x} + 3\left(x^2 - \frac{y_1^2}{x_1^2}x^2\right)\uv{y}.
\end{equation}
so that the line integral is
\begin{eqnarray}
L_2 &=& \int_O^A\vec{E}\cdot d\vec{s} \nonumber \\
 &=& \int_O^A6\frac{y_1}{x_1}x^2dx + 
 3\left(x^2 - \frac{y_1^2}{x_1^2}x^2\right)\frac{y_1}{x_1}dx \nonumber \\
 &=& 2\frac{y_1}{x_1}x_1^3 + \frac{y_1}{x_1}\left(1 - \frac{y_1^2}{x_1^2}\right)x_1^3 \nonumber \\
 &=& 3x_1^2y_1 - y_1^3 \label{e6}
\end{eqnarray}
In the third case, $d\vec{s} = \uv{x}dx + \uv{y}dy$ and
\begin{eqnarray}
L_3 &=& -\int_0^{y_1}3y^2dy + \int_0^{x_1}6xy_1dx \nonumber \\
 &=& -y_1^3 + 3x_1^2y_1 \label{e7}
\end{eqnarray}
Equations \eqref{e2}, \eqref{e6} and \eqref{e7} show that the line integrals are
the same. The potential function is
\begin{equation}\label{e8}
\varphi(x, y, 0) = -\int_O^{(x, y, 0)}\vec{E}\cdot d\vec{s} = -(3x^2y - y^3).
\end{equation}
However,
\begin{equation}\label{e9}
\varphi(x, y, z) = -\int_O^{(x, y, z)}\vec{E}\cdot d\vec{s} = -(3x^2y - y^3).
\end{equation}
is also true (why?) so that
\[
-\grad\varphi = 6xy\uv{x} + 3(x^2-y^2)\uv{y} = \vec{E}.
\]

\item The potential of the charge configuration is
\begin{equation}\label{e10}
\varphi(0, 0, z) = 12/z - 6/(z - 3)
\end{equation}
so that the variation of potential is as shown in figure \ref{c2f2}. It was 
generated using
\begin{verbatim}
import numpy as np
import matplotlib.pyplot as plt

def varphi(z: float) -> float:
    return 12/z - 6/(z - 3)
    
Z1 = np.linspace(-6, 6)
Z2 = np.linspace(-0.1, 0.1)
Z3 = np.linspace(2.9, 3.1)

Z = np.concatenate((Z1, Z2, Z3))
Z.sort()
V = [varphi(z) for z in Z]

plt.plot(Z, V)
plt.xlabel(r'$z$')
plt.ylabel(r'$\varphi(0, 0, z)$')
plt.title('Potential due to two charges on the z-axis')
plt.show()
\end{verbatim}
\begin{figure}[!ht]
\center
\includegraphics[scale=0.6]{purcell_c2p2}
\caption{Problem 2}
\label{c2f2}
\end{figure}
A few points to consider:
\begin{itemize}
\item Examine its behaviour in the regions $z < 0, z \in (0, 3)$ and $z > 3$.
\item Why did we create three arrays $Z1, Z2, Z3$ in the code?
\item Why did we sort the array $Z$?
\end{itemize}

\item The potential at a point in the $y$ axis is
\begin{equation}\label{e11}
\varphi(y) = -\frac{2}{y} + \frac{1}{\sqrt{1 + (y - 1)^2}} + \frac{1}{\sqrt{1 + (y - 1)^2}} 
= -2\left(\frac{1}{y} - \frac{1}{\sqrt{1 + (y - 1)^2}}\right)
\end{equation}
Electric field $\vec{E} = -\grad\varphi$ will be zero when $d\varphi/dy = 0$. 
A few points to note about the potential:
\begin{itemize}
\item The function blows up at the origin.
\item For $y \rightarrow \pm \infty$, $\varphi(y) \rightarrow 0$.
\item For $y < 0$, $\varphi(y) > 0$.
\item $\varphi(0^+) = \infty, \varphi(1) = 0, \varphi(y) > 0$ for $y \in (0, 1) \cup (1, \infty)$.
\end{itemize}
Now,
\[
\td{\varphi}{z} = 2\left(\frac{1}{y^2} - \frac{(y - 1)}{(y^2 - 2y + 2)^{3/2}}\right)
\]
and $d\varphi/dz = 0$ implies $(y^2 - 2y + 2)^3 = y^4(y - 1)^2$. The roots of
\[
4 y^5 - 17 y^4 + 32 y^3 - 36 y^2 + 24 y - 8 = 0
\]
can be found using
\begin{verbatim}
np.roots([4, -17, 32, -36, 24, -8]).
\end{verbatim}
They are $y \approx 1.62072, 0.427249 \pm 0.974453 i, 0.887391 \pm 0.550058$. The only 
real root is $1.62072$.
The variation of the potential along the $y$ axis is shown in figure \ref{c2f3a} to 
\ref{c2f3e}.
\begin{figure}[!ht]
\center
\includegraphics[scale=0.75]{purcell_c2p3a}
\caption{In range $(-2, 2)$.}
\label{c2f3a}
\end{figure}
\begin{figure}[!ht]
\center
\includegraphics[scale=0.75]{purcell_c2p3b}
\caption{In range $(1.5, 1.7)$.}
\label{c2f3b}
\end{figure}
\begin{figure}[!ht]
\center
\includegraphics[scale=0.75]{purcell_c2p3c}
\caption{In range $(0.1, 2)$.}
\label{c2f3c}
\end{figure}
\begin{figure}[!ht]
\center
\includegraphics[scale=0.75]{purcell_c2p3d}
\caption{In range $(-5, -0.1)$.}
\label{c2f3d}
\end{figure}
\begin{figure}[!ht]
\center
\includegraphics[scale=0.75]{purcell_c2p3e}
\caption{In range $(1.5, 5)$.}
\label{c2f3e}
\end{figure}

The figures were generated using
\begin{verbatim}
import numpy as np
import matplotlib.pyplot as plt

def varphi(y: float) -> float:
    return -2 * (1/y - 1/np.sqrt(1 + (y - 1)**2))

def plot(ymin: float,
         ymax: float,
         fname: str,
         loc: str='best',
         show_x_axis: bool=True) -> None:
    Y = np.linspace(ymin, ymax)
    V = [varphi(y) for y in Y]
    label = f'In range [{ymin}, {ymax}]'
    plt.plot(Y, V, label=label)
    if show_x_axis:
        plt.hlines(y=0, xmin=ymin, xmax=ymax, color='red')
        
    plt.xlabel(r'$y$')
    plt.ylabel(r'$\varphi(y)$')
    plt.legend(loc=loc)
    plt.savefig(fname)
    plt.close()


def main():
    plot(-2, 2, 'course/purcell_c2p3a.png')
    plot(1.5, 1.7, 'course/purcell_c2p3b.png', show_x_axis=False)   
    plot(0.1, 2, 'course/purcell_c2p3c.png', loc='lower right')
    plot(-5, -0.1, 'course/purcell_c2p3d.png')
    plot(1, 5, 'course/purcell_c2p3e.png')


if __name__ == '__main__':
    main()

\end{verbatim}

\item Given the potential
\begin{equation}\label{e11}
\varphi(x, y, z) = \begin{cases}
x^2 + y^2 + z^2 \text{ for } x^2 + y^2 + z^2 < a^2 \\
-a^2 + \frac{2a^3}{\sqrt{x^2 + y^2 + z^2}} \text{ for } a^2 < x^2 + y^2 + z^2
\end{cases}
\end{equation}
the electric field $\vec{E} = -\grad\varphi$ is
\begin{equation}\label{e12}
\vec{E} = \begin{cases} -2(x\uv{x} + y\uv{y} + z\uv{z}) \text{ for } x^2 + y^2 + z^2 < a^2 \\
2a^3\frac{x\uv{x} + y\uv{y} + z\uv{z}}{(x^2 + y^2 + z^2)^{3/2}} \text{ for } a^2 < x^2 + y^2 + z^2
\end{cases}
\end{equation}
Therefore 
\begin{equation}\label{e13}
\dive\vec{E} = \begin{cases} -6 \text{ for } x^2 + y^2 + z^2 < a^2 \\
0 \text{ for } a^2 < x^2 + y^2 + z^2
\end{cases}
\end{equation}
so that, by Gauss law, the charge density is,
\begin{equation}\label{e14}
\rho = \begin{cases} -\frac{3}{2\pi} \text{ for } x^2 + y^2 + z^2 < a^2 \\
0 \text{ for } a^2 < x^2 + y^2 + z^2
\end{cases}
\end{equation}

\item Let $a$ be the radius of the sphere. If $Q$ is the total charge on it then
the potential at its surface is
\[
\varphi = -\frac{Q}{a}.
\]
If $\sigma$ is the surface charge density then $Q = 4\pi a^2\sigma$ so that
\[
\varphi = -4\pi a\sigma
\]
that is,
\[
\sigma = -\frac{\varphi}{4\pi a}.
\]
Given that $\varphi = 1000/300$ stat volt and electronic charge is $4.8 \times
10^{-10}$ esu, 
\[
\sigma = \frac{10}{3}\frac{1}{4\pi a}\frac{10^{10}}{4.8} \approx 
\frac{5.5}{a} \times 10^{-3} \times 10^{10} \approx \frac{5.5}{a} \times 10^7.
\]

\item The electric field on the surface of the earth is
\[
\vec{E} = \frac{1}{4\pi\epsilon_0}\frac{Q}{R^2}\uv{r}.
\]
Given that $R = 6.378 \times 10^6$ m,
\[
E \approx 9 \times 10^9 \times \frac{1}{4.078 \times 10^{13}} 
\approx 2.21 \times 10^{-4} \text{V/m}.
\]
The potential at the surface is
\[
\varphi = \frac{1}{4\pi\epsilon_0}\frac{Q}{R} \approx 1411 \text{V}.
\]

\item The integral,
\[
\int_C^D\vec{E}\cdot d\vec{s} = \varphi(D) - \varphi(C).
\]
It is easy to get the terms on the rhs.
\begin{eqnarray}
\varphi(C) &=& -\frac{2}{2\sqrt{5}} + \frac{3}{5} \label{e16} \\
\varphi(D) &=& -\frac{2}{5} + \frac{3}{2\sqrt{5}} \label{e17}
\end{eqnarray}
so that
\[
\int_C^D\vec{E}\cdot d\vec{s} = \frac{\sqrt{5} - 2}{2}.
\]

\item For the infinitely long cylinder of radius $a$ whose cross section is shown
in figure 2.17 of the book, the electric field is normal to the curved surface of
the cylinder. In order to get the field at a point which is at a distance $r$ from
the cylinder's axis, align the coordinates so that $z$ axis coincides with the 
cylinder's axis. Consider a pillbox coaxial with the cylinder and of radius $r$.
If $r < a$, the pillbox encloses a charge $\pi r^2 h \rho$, where $h$ is the
pillbox's height. The flux through the pillbox is $2\pi rh E$. Therefore, by
Gauss' law,
\[
2\pi rh E = 4\pi (\pi r^2h \rho)
\]
so that
\begin{equation}\label{e18}
\vec{E} = 2\pi\rho \vec{r}, \text{ if } r < a.
\end{equation}
If $r \ge a$, a similar analysis yields
\[
2\pi rh E = 4\pi (\pi a^2 h \rho)
\]
so that
\begin{equation}\label{e19}
\vec{E} = 2\pi\rho \frac{a^2}{r}\uv{r}, \text{ if } r \ge a.
\end{equation}
We are asked to find the potential assuming $\varphi(0) = 0$. Thus, if $r < a$,
\begin{equation}\label{e20}
\varphi(r) = \int_0^r\vec{E}\cdot d\vec{s} = 
\int_0^r 2\pi\rho \vec{r}^\op\cdot d\vec{r}^\op = \pi\rho r^2 \text{ if } r < a.
\end{equation}
If $r \ge a$,
\begin{eqnarray}
\varphi(r) &=& \int_0^r\vec{E}\cdot d\vec{s} \nonumber \\
 &=& \int_0^a\vec{E}\cdot d\vec{s} + \int_a^r\vec{E}\cdot d\vec{s} \nonumber \\
 &=& \pi\rho a^2 + 2\pi\rho a^2 \int_a^r \frac{dr^\op}{r^\op} \nonumber \\
 &=& \pi\rho a^2 + 2\pi\rho a^2\ln\left(\frac{r}{a}\right) \nonumber \\
 &=& \pi\rho a^2\left(1 + \ln\left(\frac{r^2}{a^2}\right)\right) \label{e21}
\end{eqnarray}
Note that $\varphi$ is continuous at $r = a$. So is the electric field.

\item The potential at the rim is $4\sigma a$ and that on the $y$ axis is 
\[
\varphi(0, y, 0) = 2\pi\sigma(\sqrt{y^2 + a^2} \pm y)
\]
so that the point on $y$ axis where the said equipotential cuts the $y$ axis
is given by the equation
\[
\pi(\sqrt{y^2 + a^2} \pm y) = 2 a.
\]
As expected, this equation is independent of $\sigma$. It is a purely geometrical
fact. I cannot sketch the equipotential surface without knowing its functional 
form. Finding $\varphi$ at an arbitrary point from the dissc is not a trivial 
problem.

\item The potential at a point on the $z$ axis is
\[
d\varphi(2d) = \frac{dq}{2d - z} = \lambda\frac{dz}{2d - z}
\]
so that
\begin{equation}\label{e22}
\varphi(2d) = \int_{-d}^d d\varphi(z) = -\int_{-d}^d\frac{dz}{z - 2d} = \lambda\ln 3
\end{equation}
For a point on the $x$ axis,
\[
d\varphi(x) = \frac{dq}{\sqrt{x^2 + z^2}}
\]
so that
\begin{eqnarray}
\varphi(x) &=& \lambda\int_{-d}^d\frac{dz}{\sqrt{x^2 + z^2}} \nonumber \\
 &=& \lambda\int_{-\alpha}^\alpha \sec\theta d\theta\;\text{ where }\alpha = \tan^{-1}(d/x) \nonumber \\
 &=& \lambda\ln|\sec\theta + \tan\theta|\Big|_{-\alpha}^\alpha \nonumber \\
 &=& \lambda\ln\left|\frac{\sqrt{x^2 + d^2} + d}{\sqrt{x^2 + d^2} - d}\right| \label{e23}
\end{eqnarray}
$\varphi(z = 2d) = \varphi(x)$ implies $\sqrt{x^2 + d^2} + d = 3(\sqrt{x^2 + d^2} - d)
\Rightarrow x = d\sqrt{3}$.

\item The distance between the point $P = (3d/2, 0, d)$ and a point $(0, 0, z)$ on
the rod is
\begin{equation}\label{e24}
r = \sqrt{\frac{9d^2}{4} + 0 + (d - z)^2}
\end{equation}
so that the potential at it due to a small charge element $dq$ at $z$ is
\[
d\varphi(P) = \frac{dq}{r} = 2\lambda\frac{dz}{\sqrt{9d^2 + 4(d - z)^2}}
\]
and 
\[
\varphi(P) = 2\lambda\int_{-d}^d\frac{dz}{\sqrt{9d^2 + 4(d - z)^2}}
\]
Let $u = 2(d - z)$ so that $du = -2dz$ and the limits of integral are from $u=4d$
to $z = 0$ and
\[
\varphi(P) = -\lambda\int_{4d}^0\frac{du}{\sqrt{9d^2 + u^2}}.
\]
If $u = 3d\tan\theta$ then $du = 3d\sec^2\theta d\theta$ and the limit of the 
integral are from $\alpha = \tan^{-1}(4/3)$ to $\theta = 0$.
\[
\varphi(P) = -\lambda\int_{\alpha}^0\sec\theta d\theta = 
-\lambda\ln|\sec\theta + \tan\theta|\Big|_{-\alpha}^0 =
-(0 - \lambda\ln 3) = \lambda\ln 3.
\]

We will repeat this analysis for an arbitrary point $Q = (X, 0, Z)$. Its distance 
from a point $(0, 0, z)$ on the rod is
\begin{equation}\label{e25}
r = \sqrt{X^2 + (Z - z)^2}
\end{equation}
so that the potential at it us
\[
\varphi(Q) = \lambda\int_{-d}^d\frac{dz}{\sqrt{X^2 + (Z - z)^2}}
\]
Let $u = Z - z$ so that $du = -dz$ and the limits of the integral go from
$Z + d$ to $Z - d$ and
\[
\varphi(Q) = -\lambda\int_{Z+d}^{Z-d}\frac{du}{\sqrt{X^2 + u^2}} = 
\lambda\int_{Z-d}^{Z+d}\frac{du}{\sqrt{X^2 + u^2}}.
\]
If $u = X\tan\theta$, $du = X\sec^2\theta d\theta$ and the limits of the
integral become 
\[
\alpha = \tan^{-1}\left(\frac{Z - d}{X}\right) \;\text{and}\;
\beta = \tan^{-1}\left(\frac{Z + d}{X}\right).
\]
We then have,
\[
\varphi(Q) = \lambda\int_\alpha^\beta \sec\theta d\theta = 
\lambda\ln|\sec\theta + \tan\theta|\Big|_\alpha^\beta.
\]
Now,
\[
\tan\alpha = \frac{Z-d}{X} \Rightarrow \sec\alpha=\frac{\sqrt{X^2 + (Z-d)^2}}{X}
\]
so that
\[
\varphi(Q) = \lambda\ln\left|\frac{\sqrt{X^2 + (Z+d)^2} + Z+d}{X}\right| - 
\lambda\ln\left|\frac{\sqrt{X^2 + (Z-d)^2} + Z-d}{X}\right|
\]
or
\begin{equation}\label{e26}
\varphi(Q) = \lambda\ln\left|\frac{\sqrt{X^2 + (Z+d)^2} + Z+d}{\sqrt{X^2 + (Z-d)^2} + Z-d}\right|
\end{equation}
$\varphi(Q)$ will be equal to $\varphi(P)$ when
\[
\frac{\sqrt{X^2 + (Z+d)^2} + Z+d}{\sqrt{X^2 + (Z-d)^2} + Z-d} = \sqrt{3}
\]
In general, if $\varphi(P) = k$ then the equation of the equipotential line is
\begin{equation}\label{e27}
\sqrt{X^2 + (Z+d)^2} + Z+d = k\sqrt{X^2 + (Z-d)^2} + kZ - kd.
\end{equation}
If
\begin{equation}\label{e28}
\frac{X^2}{a^2 - d^2} + \frac{Z^2}{a^2} = 1
\end{equation}
then
\begin{equation}\label{e29}
X^2 = a^2 - Z^2 - d^2 + \frac{Z^2d^2}{a^2}
\end{equation}
and
\[
X^2 + (Z \pm d)^2 = a^2 + \frac{Z^2d^2}{a^2} \pm 2Zd = \left(\frac{Zd}{a} \pm a\right)^2.
\]
Substituting this in \eqref{e27}, we get
\begin{equation}\label{e30}
\frac{Zd}{a} + a + Z + d = k\left(\frac{Zd}{a} - a\right) + kZ - kd,
\end{equation}
that is
\[
(k + 1)(a + d) = (k - 1)Z\frac{a + d}{a} \Rightarrow a(k + 1) = (k - 1)Z.
\]
Thus, if
\begin{equation}\label{e31}
Z = \frac{k + 1}{k - 1}a,
\end{equation}
then the point $(X, Z)$ lies on the ellipse defined by \eqref{e28}.

\item Refer to figure 2.12 of the book. We will first find the potential due to
the shaded strip in it. Let $q$ be the charge on it, $h$ be its height and $x$
be its distance from $P$. The potential due to a charge element $dq$ at height
$y$ at $P$ is
\[
\varphi(P) = \frac{dq}{r} = \lambda\frac{dy}{\sqrt{x^2 + y^2}}
\]
and 
\[
\varphi(P) = \lambda\int_0^h\frac{dy}{\sqrt{x^2 + y^2}} = 
\lambda\int_0^\theta\sec\psi d\psi,
\]
where $y = x\tan\psi$ and $\theta = \tan^{-1}(h/x)$. Thus,
\begin{equation}\label{e32}
\varphi(P) = \frac{q}{h}\ln|\sec\theta + \tan\theta|.
\end{equation}
To extend this solution to the potential due to the triangular region, let
the strip by of height $h$ and thickness $dx$ so that the charge on it is
$dq = \sigma hdx$ and we have
\[
d\varphi(P) = \sigma dx\ln|\sec\theta + \tan\theta|
\]
and
\begin{equation}\label{e33}
\varphi(P) = \int_0^b\sigma dx\ln|\sec\theta + \tan\theta| = 
\sigma b\ln|\sec\theta + \tan\theta|.
\end{equation}

\item It is easy to check that $\curl\vec{E} = 0$.

\item $\nabla^2 f \ne 0, \nabla^2 g = 0$. Further $\grad g = 2(x\uv{x} - y\uv{y})$.
The Hessian determinant of $g$ is a constant, $-4$. Since it is negative, all extrema
are saddle points.

The function $f$, on the other hand, is an elliptic paraboloid. Since $\grad f = 
2(x\uv{x} - y\uv{y})$, the origin $(0, 0)$ is a global extremum. The Hessian 
determinant at $(0, 0)$ is $4$ and $g_{xx} = g_{yy} = 2 > 0$. Therefore, the 
extremum is indeed a minimum.

\item 
\begin{enumerate}
\item If $\vec{F} = (x + y)\uv{x} + (-x + y)\uv{y} - 2z\uv{z}$, $\dive\vec{F} = 0$
and $\curl\vec{F} = -2\uv{x}$.

\item If $\vec{G} = 2y\uv{x} + (2x + 3z)\uv{y} + 3y\uv{z}$, $\dive\vec{G} = 0$ and
$\curl\vec{G} = 0$. Therefore, we can find a function $\varphi$ such that $\vec{G}
= \grad\varphi$. The field $\vec{G}$ vanishes at the origin. If we assume that the
potential also vanishes there,
\[
\varphi(x, y, z) = \int_{(0, 0, 0)}^{(x, y, z)} \vec{G}(x^\op, y^\op, z^\op)\cdot d\vec{s},
\]
along any curve joining the limits of the integral. Choose a curve composed of the
straight lines $(0, 0, 0)$ to $(x, 0, 0)$, $(x, 0, 0)$ to $(x, y, 0)$ and $(x, y, 0)$
to $(x, y, z)$. The field takes the forms $2x^\op\uv{y}$, $2y^\op\uv{x} + 2x\uv{y}
+ 3y^\op\uv{z}$ and $2y\uv{x} + (2x + 3z^\op)\uv{y} + 3y\uv{z}$ along the three
lines. Then,
\begin{eqnarray*}
\varphi(x, y, z) &=& \int_{(0, 0, 0)}^{(x, 0, 0)}\vec{G}\cdot\uv{x}dx +
\int_{(x, 0, 0)}^{(x, y, 0)}\vec{G}\cdot\uv{y}dy + 
\int_{(x, y, 0)}^{(x, y, z)}\vec{G}\cdot\uv{z}dz \\
 &=& 0 + 2x\int_{(x, 0, 0)}^{(x, y, 0)} dy^\op + 3y\int_{(x, y, 0)}^{(x, y, z)} dz^\op \\
 &=& 2xy + 3yz.
\end{eqnarray*}
We confirm that $\grad\varphi = 2y\uv{x} + (2x + 3z)\uv{y} + 3y\uv{z} = \vec{G}$.

\item If $\vec{H} = (x^2 - z^2)\uv{x} + 2\uv{y} + 2xz\uv{z}$ then $\dive\vec{H}
 = 4x$ and $\curl\vec{H} = -4z\uv{y}$.
\end{enumerate}

\item Part (a) is a straightforward manipulation in Cartesian coordinates. The
second method is superior because the proof is independent of the coordinates.
In figure 2.16 of the book, let the volume $V$ be composed of the top portion
$V_1$ and the bottom portion $V_2$. Let the surface $S$ be common to both.
Then,
\begin{eqnarray*}
\int_V\dive\curl\vec{A}\;dv &=& \int_{V_1}\dive\curl\vec{A}\;dv + 
  \int_{V_2}\dive\curl\vec{A}\;dv \\
  &=& \int_{S_1}\curl\vec{A}\cdot d\vec{a} + \int_{S_2}\curl\vec{A}\cdot d\vec{a},
\end{eqnarray*}
where $S_1$ and $S_2$ are closed surfaces that include the outer surface and the
one enclosed by the curve $C$ in the figure. Since they are both closed surfaces,
\[
\int_V\dive\curl\vec{A}\;dv = \int_{C_1}\vec{A}\cdot d\vec{s} + 
\int_{C_2}\vec{A}\cdot d\vec{s} = 0 + 0
\]
Since this is true for any volume $V$, we have $\dive\curl\vec{A} = 0$.

\item We have to prove the equivalence of
\begin{equation}\label{e34}
U = \frac{1}{8\pi}\int E^2 dv
\end{equation}
and
\begin{equation}\label{e35}
U = \frac{1}{2}\int\rho\varphi dv
\end{equation}
for a charge distribution of \emph{finite extent}. If $\varphi$ is the potential
due to the distribution $\rho$,
\[
\int_V \dive(\varphi\grad\varphi)dv = \int_S \varphi\grad\varphi\cdot d\vec{a}.
\]
Choose $V$ to be very large so that on the bounding surface $S$, $\varphi$ goes
as $r^{-1}$, $\grad\varphi$ as $r^{-2}$ and the area itself as $r^2$. Thus, if $S$
is very far from the charge distribution, which we are assured to be of finite
extend, then the surface integral can be made vanishingly small. Thus,
\[
\int_V \dive(\varphi\grad\varphi)dv = 0.
\]
Since $\dive(\varphi\grad\varphi) = |\grad\varphi|^2 + \varphi\nabla^2\varphi =
E^2 - 4\pi\varphi\rho$,
\[
\int_V E^2 dv = 4\pi\int\rho\varphi dv
\]
from which the equivalence of \eqref{e34} and \eqref{e35} follows.

The idea of choosing a very large volume to integrate over a function that is
non-zero over a finite region in space so that the transformed surface integral
is zero is very common in physics.

\item We will find the potential at an arbitrary point on the axis of the cylinder.
Align the axes such that the $z$ axis coincides with the cylinder's principal axis 
and the origin is at a distance $b/2$ from either extremity.

The potential due to a ring of charge at distance $r$ from the field point 
$(0, 0, z_0)$ is
\[
d\varphi = \frac{dq}{r} = \frac{\sigma \times 2\pi adz}{\sqrt{a^2 + (z - z_0)^2}}
\]
and
\[
\varphi(z_0) = 2\pi a\sigma\int_{-b/2}^{b/2}\frac{dz}{\sqrt{a^2 + (z - z_0)^2}}.
\]
Let $(z - z_0) = a\tan\theta$ so that $dz = a\sec^2\theta d\theta$ and the limits
of the integral are from
\[
\alpha = \tan^{-1}\left(\frac{-b-2z_0}{2a}\right)  \text{ to } 
\beta = \tan^{-1}\left(\frac{b - 2z_0}{2a}\right).
\]
Therefore,
\[
\varphi(z_0) = 2\pi a\sigma\ln\left|\frac{\sec\beta + \tan\beta}{\sec\alpha + \tan\alpha}\right|.
\]
Substituting for $\alpha$ and $\beta$ we get
\[
\varphi(z_0) = 2\pi a\sigma\ln\left|\frac{\sqrt{4a^2 + (b - 2z_0)^2} + b - 2z_0}{\sqrt{4a^2 + (b + 2z_0)^2} + b + 2z_0}\right|
\]
Note that when $\tan\alpha < 0$ then so is $\sec\alpha$ so that the denominator 
is really the sum of two negative terms whose modulus is the sum of corresponding
positive terms. In general, we can write
\begin{equation}\label{e36}
\varphi(z) = 2\pi a\sigma\ln\left|\frac{\sqrt{4a^2 + (b - 2z)^2} + b - 2z}{\sqrt{4a^2 + (b + 2z)^2} + b + 2z}\right|
\end{equation}
Clearly,
\begin{eqnarray*}
\varphi(b/2) &=& 2\pi a\sigma\ln\left|\frac{a}{\sqrt{a^2+b^2} + b}\right| \\
\varphi(0) &=& 0 \\
\varphi(-b/2) &=& 2\pi a\sigma\ln\left|\frac{\sqrt{a^2+b^2} + b}{a}\right|
\end{eqnarray*}
Therefore,
\begin{eqnarray*}
\varphi(b/2) - \varphi(0) &=& 2\pi a\sigma\ln\left|\frac{a}{\sqrt{a^2+b^2} + b}\right| \\
\varphi(0) - \varphi(-b/2) &=& 2\pi a\sigma\ln\left|\frac{\sqrt{a^2+b^2} + b}{a}\right| \\
 &=& 2\pi a\sigma\ln\left|\frac{a}{\sqrt{a^2+b^2} + b}\right| \\
 &=& \varphi(b/2) - \varphi(0)
\end{eqnarray*}
From \eqref{e36}, we get
\begin{equation}\label{e37}
\vec{E} = 4\pi\sigma a\left(\frac{1}{\sqrt{4a^2 + (b - 2z)^2}} + \frac{1}{\sqrt{4a^2 + (b + 2z)^2}}\right).
\end{equation}
Figure \ref{c2f18} shows the variation of the electric field in the region around
the cylinder. It was generated using:
\begin{verbatim}
import numpy as np
import matplotlib.pyplot as plt

a = 1
b = 1
sigma = 4/np.pi # Chosen so that 4\pi\sigma a = 1 !!
K = 4*np.pi*sigma*a

def E_field(z: float) -> float:
    return K*((4*a**2+(b-2*z)**2)**(-1/2)+\
              (4*a**2+(b+2*z)**2)**(-1/2))

def main():
    Z = np.linspace(-4*b, 4*b, 200)
    E = [E_field(z) for z in Z]
    plt.plot(Z, E)
    plt.axvline(x=-b/2, ls='--')
    plt.axvline(x=b/2, ls='--')
    plt.xlabel(r'$z$')
    plt.ylabel(r'$E(z)$')
    plt.title('Electric field in a charged cylinder')
    plt.savefig('course/purcell_c2p18.png')


if __name__ == '__main__':
    main()
\end{verbatim}
\begin{figure}[!ht]
\center
\includegraphics[scale=0.75]{purcell_c2p18}
\caption{$E(z)$ for $a=1, b=1$. The cylinder extends from $z=-1/2$ to $z=1/2$.}
\label{c2f18}
\end{figure}

\item When the spheres are so far apart their presence does not affect the charge
distribution on each other we can consider them to be point charges. Let one of 
them be centred at the origin and the other one centred at a distance $a$ on the
$x$ axis. If one of them has a charge $q$ and the other $Q-q$ then the energy of
the configuration is
\[
U(q) = \frac{q(Q - q)}{a}
\]
so that $aU^\op(q) = (Q - q) - q = Q - 2q$. Thus, the potential energy is minimised
when $q = Q/2$, that is when the charges are evenly distributed.

Note that this analysis is valid only when $a$ is much larger than the radii of the
spheres.

\item We first find the potential at the centre of a uniformly charged sphere.
If $\rho$ is the charge density then at a point a distance $r$ from the centre,
\[
E \times 4\pi r^2 = 4\pi q_{enc} = 4\pi\rho\frac{4\pi}{3}r^2 \Rightarrow
\vec{E} = \frac{4\pi}{3}\rho r\uv{z}.
\]
The potential difference between the centre and the surface of the sphere is
\[
\varphi(a) = -\int\vec{E}\cdot d\vec{s} = -\int_0^a \frac{4\pi}{3}\rho rdr
= -\frac{2\pi}{3}\rho a^2.
\]
If $Q = 79e$ is the charge on the gold nucleus,
\[
\rho = \frac{3Q}{4\pi a^3}
\]
so that
\[
\varphi(a) = -\frac{Q}{2a}
\]
With $Q = 79e$ and $a = 6 \times 10^{-13}$ cm, $\varphi(a) = -94 800$ statvolt or
$2.844 \times 10^{7}$ V. This is a tremendous potential difference in a structure
as small as a gold nucleus. The enormous electric field is overpowered by the
strong nuclear force holding the nucleus together.

\item The first point to consider is whether gravity should even be mentioned in
this problem. If each of the cube's sides is of length $2a$ and if we align the
Cartesian coordinate axes such that the origin coincides with the centre of the
cube and the edges of the cube are parallel to the axes then the eight vertices
of the cube have coordinates that are a permutation of$(\pm a, \pm a, \pm a)$.
If the electron were at a point $(x, y, z)$ then its distance from the vertices
is $\sqrt{(x \pm a)^2 + (y \pm a)^2 + (z \pm a)^2}$ and the potential due to a
proton is
\[
\frac{e}{\sqrt{(x \pm a)^2 + (y \pm a)^2 + (z \pm a)^2}}
\]
and the total potential is
\[
\varphi(x, y, z) = \sum \frac{e}{\sqrt{(x \pm a)^2 + (y \pm a)^2 + (z \pm a)^2}},
\]
where the summation runs over all permutations. To find the extremum of this
potential, we find
\[
\grad\phi(x,y,z) = -\sum\frac{(x \pm a)\uv{x}+(y \pm a)\uv{y}+(z \pm a)\uv{z}}
{((x \pm a)^2 + (y \pm a)^2 + (z \pm a)^2)^{3/2}}
\]
It is not easy to find the extremum of $\varphi$ from this expression by writing
all terms of the sum. Instead, we note that is $x = y = z = 0$ then the denominators
of all terms will be $3\sqrt{3}a^{3/2}$ and the numerators will all add up to zero.
Thus, $(x = 0, y = 0, z = 0)$ is an extremum. It is also the point where the 
electrical force due to all protons is exactly zero. In order to investigate the
nature of this extremum, we need the Hessian determinant, each term of which is
a sum of eight terms. Instead, we invoke a general property of Laplace's function
which is that $\varphi$ will not have a minimum or a maximum. Therefore, in spite
of the origin being a point of equilibrium, an electron does not stay at rest there.
The extremum will be a saddle point and the electron will find a path to escape.

\item We use the formula,
\[
V = \frac{1}{4\pi\epsilon_0}\frac{Q}{R},
\] for the potential of a charged sphere so that
\[
Q = -\frac{0.15 \times 3 \times 10^{-7}}{9 \times 10^9} = -50 \times 10^{-14}C
\]
The number of electrons making up this charge is
\[
N = \frac{Q}{e} \approx 3 \times 10^4.
\]

\item The proton approaches to silver nucleus with an energy of $5e\times 10^6$ J,
where $e$ is the charge on the proton. It uses this energy to climb up the 
Coulomb potential of the silver nuclues. The closest the proton can approach a
nucleus is when this kinetic energy is converted entirely into the potential 
energy. If $a$ is the separation between the two,
\[
\frac{1}{4\pi\epsilon_0}\frac{Ze^2}{a} = 5e \times 10^6.
\]
Using $Z = 47$, we get $a \approx 1.3536 \times 10^{-14}$ m. The proton is halted
roughly at a distance of ten times the nuclear radius from the centre of the
nucleus.

\item Quite straightforward.

\item We can choose a convenient point on each of the curves. 
\begin{itemize}
\item On curve $A$, choose the point $y = 1$. The potentials due to the negative
charges is equal to $-1/\sqrt{2} - 1/\sqrt{2}$ and that due to positive charges
is $2 + 2/3$. Thus the total potential is $4/3 - \sqrt{2}$.
\item Curve $B$ crosses the $x$ axis at $x = 7/2$. The potential due to the
positive charges is
\[
-\frac{1}{5/2} - \frac{1}{9/2} = -\frac{2}{5} - \frac{2}{9} = -\frac{28}{45}.
\]
The distance from the positive charges is $\sqrt{65}/2$ so that their contribution
is $4/\sqrt{65} + 4/\sqrt{65}$. The total potential is
\[
V_B = \frac{8}{\sqrt{65}} - \frac{28}{45}.
\]
\item Curve $C$ passes through the origin. The potential at the origin is $-1
-1 + 2/2 + 2/2 = 0$. 
\end{itemize}

\item From equation (20) of the book, the potential at the centre of a charged
disc of diameter $d$ is
\[
\varphi_D = \pi\sigma d.
\]
We can create a square of side $s = 2a$ by combining eight triangles of the kind
treated in problem 12 with $a = b$. The potential due to each triangle at the 
centre is $\sigma a \ln(1 + \sqrt{2})$ as $\theta = \pi/4$. Thus,
\[
\varphi_S = 8 \times \sigma a \ln(1 + \sqrt{2}) = 4s\sigma\ln(1 + \sqrt{2}).
\]
If $\varphi_S = \varphi_D$, we must have
\[
\frac{s}{d} = \frac{\pi}{4\ln(\sqrt{2} + 1)}.
\]

\item From equation (25) of the book, the potential at the rim of a disc of radius
$r$ and surface charge density is $4\sigma r$, Now bring a charge $dq = \sigma 
\times 2\pi rdr$ from infinity to it. The energy needed is
\[
dU = -4\sigma r dq = -8\pi\sigma^2 r^2 dr.
\]
The total energy is
\[
U = \int_0^a dU = -8\pi\sigma^2\frac{a^3}{3}.
\]
Now, $Q = \sigma \pi a^2$ so that $\sigma^2 = Q^2/(\pi^2 a^4)$ and hence
\[
U = -\frac{8Q^2}{3\pi a}.
\]

\item The potential due to a section of an annular ring is
\[
d\varphi = \frac{\sigma da}{r} = 2\pi\sigma dr
\]
so that if the inner and outer radii are $r_1$ and $r_2$ then
\[
\varphi = 2\pi\sigma (r_2 - r_1) = 
2\pi\frac{Q}{\pi r_2^2 - \pi r_1^2}(r_2 - r_1)
= \frac{2Q}{r_2 + r_1}
\]
If $\langle r \rangle$ is the mean radius of the annuluar disc then the potential
is just $Q/\langle r \rangle$.

The potential at the centre of the disc with $\sigma = -4$ esu/cm$^2$, $r_1 = 1$
cm and $r_2 = 3$ cm is $\varphi = 2\pi(-4)(3 - 1) = -16\pi$ statvolts. An electron
constrained to move along the axis of the disc will convert this potential energy
into kinetic energy. The potential energy of such an electron is $U = -e(-16\pi)
= 16\pi e$. Therefore the maximum kinetic energy it can have is
\[
\frac{1}{2}mv^2 = 16\pi e \Rightarrow v^2 = 32\pi\frac{e}{m} \Rightarrow
v = 4\sqrt{2\pi\frac{e}{m}}
\]
After putting the values of the constants, we get $v = 7.32 \times 10^9$ cm/s.

A few points to ponder:
\begin{itemize}
\item One can calculate the final velocity by calculating the force as well,
but it is a much harder way to get the answer.
\item In practice, the accelerating electron will radiate and a part of the
energy will be spent in the radiation emission.
\item The final speed of the electron is a quarter of the speed of light in
vacuum. We are better off using relativistic calculations from the start.
\end{itemize}

\item The potentials of the two spheres on and outside their surfaces is as if
the entire charge were concentrated at their centres. When the two spheres are 
touching each other, the distance between the two, equivalent ``point charges''
is $2a$ and the potential energy of the configuration is
\[
U = -\frac{Q^2}{2a}.
\]
The work needed to separate them a great distance apart is $-U$.

By Gauss' law, it is easy to show that
\[
\vec{E} = \begin{cases} 0 & \text{ if } 0 \le r < a \\
\frac{Q}{|\vec{r} - \vec{r}_0|^3}(\vec{r} - \vec{r}_0) & \text{ if } r \ge a
\end{cases}
\]
where the $\vec{r}_0$ is the centre of the shell.

\item The potential at the centre of a charged body of ``size'' $s$ and charge
$Q$ on it is proportional to $Q/s$. Since $Q = \rho s^3$, we have
\[
\varphi_\text{centre} \;\propto\; \rho s^2.
\]
The potential at the centre of a cube of size $2s$ is proportional to $4\rho s^2$.
But this is eight times the potential due to corners of the eight cubes of size
$s$ that built it. Therefore, the potential at the corner is $\varphi_{\text{
corner}} \;\propto\; \rho s^2/2$. Thus,
\[
\frac{\varphi_{\text{corner}}}{\varphi_\text{centre}} = \frac{1}{2}.
\]

\item If $\varphi = \varphi_0 e^{-kz}\cos(kx)$ then
\begin{eqnarray*}
\frac{\partial^2\varphi}{\partial x^2} &=& -k^2\varphi_0 e^{-kz}\cos(kx) \\
\frac{\partial^2\varphi}{\partial y^2} &=& 0 \\
\frac{\partial^2\varphi}{\partial z^2} &=& k^2\varphi_0 e^{-kz}\cos(kx)
\end{eqnarray*}
so that $\nabla^2\varphi = 0$. The electric field lines are given by
\[
\vec{E} = -\grad\varphi = k\varphi_0 e^{-kz}\sin(kx)\uv{x} + 
k\varphi_0 e^{-kz}\cos(kx)\uv{z}
\]
that is
\[
\vec{E} = k\varphi_0 e^{-kz}(\sin(kx)\uv{x} + \cos(kx)\uv{z})
\]
The field is sketched in figure \ref{c2f31}. It was generated using
\begin{verbatim}
import numpy as np
import matplotlib.pyplot as plt

# Two constants of the problem.
phi_0 = 1
k = 1

x, z = np.meshgrid(np.linspace(-5, 5), np.linspace(0, 5))
E_x = k*phi_0*np.exp(-k*z) * np.sin(k*x)
E_z = k*phi_0*np.exp(-k*z) * np.cos(k*x)


plt.quiver(x, z, E_x, E_z, color='b')
plt.xlabel('x')
plt.ylabel('z')
plt.title('Electric field in upper half space.')
plt.grid()
plt.savefig('course/purcell_c2p31a.png')
\end{verbatim}
\begin{figure}[!ht]
\center
\includegraphics[scale=0.75]{purcell_c2p31a}
\caption{$E(z)$ for $z > 0$.}
\label{c2f31}
\end{figure}
The charge density seems to alternate between positive and negative patches 
arranged periodically on the sheet. The positive charges around $x \pm 6n$ 
followed by negative charges around $x = \pm 3(2m + 1)$, where $m. n$ are
integers. The patches are strips running parallel to the $y$ axis.

\item When we reverse the direction of $\uv{n}$ the lhs changes sign but the rhs
is always positive.
\end{enumerate}

\section{Potential of a uniformly charged disc}
The textbook mentions that the potential at arbitrary points due to a uniformly
charged disc can be expressed in terms of elliptic functions. We will derive the
expresions here following the paper (\href{https://arxiv.org/pdf/2004.04540}{pre-print})\cite{bs}.
\subsection{Arbitrary point on the disc}
\subsection{Arbitrary point not on the disc}

\begin{thebibliography}{1}
\bibitem{bs} On the electrostatic potential and electric field of a uniformly charged disk.
published in the European Journal of Physics 41.4 (2020): 045201
\end{thebibliography}
\end{document}