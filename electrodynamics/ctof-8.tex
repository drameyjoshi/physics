\chapter{The field of moving charges}\label{c8}
\begin{enumerate}
\item We will consider the situation in which electromagnetic fields vary in the
presence of charges and currents. Since
\[
\pdt{F^{\mu\nu}}{x^\nu} = -\frac{4\pi}{c}J^\mu,
\]
after using the definition of the field tensor in terms of the potentials,
\[
F^{\mu\nu} = \pdt{A^\nu}{x_\mu} - \pdt{A^\mu}{x_\nu},
\]
we get
\[
\frac{\partial}{\partial x_\mu}\left(\pdt{A^\nu}{x^\nu}\right) - 
\frac{\partial^2 A^\mu}{\partial x^\nu \partial x_\nu} = -\frac{4\pi}{c}J^\mu
\]
We now use the Lorentz gauge condition
\[
\pdt{A^\nu}{x^\nu} = 0
\]
to get
\begin{equation}\label{c8e1}
\frac{\partial^2 A^\mu}{\partial x^\nu \partial x_\nu} = \frac{4\pi}{c}J^\mu.
\end{equation}
In terms of the d'Alembertian, we can write it as
\begin{equation}\label{c8e2}
\Box A^\mu = \frac{4\pi}{c}J^\mu.
\end{equation}
Since
\[
\Box = \frac{1}{c^2}\frac{\partial^2}{\partial t^2} - \nabla^2,
\]
equations \eqref{c8e1} and \eqref{c8e2} are equivalent to
\begin{eqnarray}
\nabla^2\varphi - \frac{1}{c^2}\spdt{\varphi}{t} &=& -4\pi\rho \label{c8e3} \\
\nabla^2\vec{A} - \frac{1}{c^2}\spdt{\vec{A}}{t} &=& 
-\frac{4\pi}{c}\vec{J}. \label{c8e4}
\end{eqnarray}
These are wave equations with source terms.

\item The solution of an inhomogeneous differential equation is the sum of the
solution of the corresponding homogeneous equation and a particular integral.
The homogenous equation gives fields due to charges and currents `external' to
the sytem while the particular integral gives fields due to those in the system
described by the rhs of equation \eqref{c8e1}. 

\item The equations \eqref{c8e3} and \eqref{c8e4} are linear. Therefore, we can
split their rhs into parts, compute the particular integral for each one of them
and add them to get the particular integral of the entire distribution of charge
and current density.

Consider a tiny region of charge density and choose the origin to lie in it. If
it contains a charge $q$ then the charge density only due to it can be expressed
as 
\begin{equation}\label{c8e5}
\rho = q\delta(\vec{r}).
\end{equation}
Recall that the dimension of the delta function of a 3-vector is $L^{-3}$. Upon
substitution in \eqref{c8e3} we get
\[
\nabla^2\varphi - \frac{1}{c^2}\spdt{\varphi}{t} = -4\pi q\delta(\vec{r}).
\]
Outside the small region surrounding the origin, this equation is 
\[
\nabla^2\varphi - \frac{1}{c^2}\spdt{\varphi}{t} = 0
\]
and the field $\varphi$ is produced because of charge at the origin. The field 
is spherically symmetric and hence $\varphi$ is a function of $r$ and $t$ alone. 
If
\begin{equation}\label{c8e6}
\varphi(r, t) = \frac{\chi(r, t)}{r}
\end{equation}
then, after expressing $\nabla^2$ in spherical polar coordinates, we get
\begin{equation}\label{c8e7}
\spdt{\chi}{r} - \frac{1}{c^2}\spdt{\chi}{t} = 0,
\end{equation}
whose solution we know can be written as
\begin{equation}\label{c8e8}
\chi(r, t) = f_1\left(t - \frac{r}{c}\right) + f_2\left(t + \frac{r}{c}\right),
\end{equation}
where $f_1$ and $f_2$ are arbitrary functions. $f_1$ is the contribution of the
source at time $t$ as it was at time $t - r/c$ while $f_2$ is the contribution
of the source as it would be at a time $t + r/c$ in the future. Since future 
does not determine the present, we choose $f_2$ to be zero and write 
\eqref{c8e6} as 
\begin{equation}\label{c8e9}
\varphi(r, t) = \frac{\chi(t - r/c)}{r}.
\end{equation}
We still do not know the form of $\chi$. Very close to the origin, $\varphi$ 
must look like the potential due to a the charge at the origin. If we write 
\begin{equation}\label{c8e10}
\delta q = q\delta(\vec{r})
\end{equation}
then
\begin{equation}\label{c8e11}
\varphi(\vec{r}, t) = \frac{\delta q (t - r/c)}{r}.
\end{equation}
so that the contribution due to all charges is
\begin{equation}\label{c8e12}
\varphi(\vec{r}, t)=
\int \frac{1}{r}\rho\left(\vec{r}^\op, t - \frac{r}{c}\right)dv^\op.
\end{equation}
This is the particular integral of \eqref{c8e3}. The potential at the field 
point $\vec{r}$ at a time $t$ depends on the source at $\vec{r}$ as it was at 
a time $t - r/c$. So far we assumed that the sources are at the origin. If they
are not then the potential at $\vec{r}$ at time $t$ will depend on the sources
at $\vec{R} = \vec{r} - \vec{r}^\op$ at time $t_r$ given by $t_r + R/c = t_r$. 
The general solution of \eqref{c8e3} is
\begin{equation}\label{c8e13}
\varphi(\vec{r}, t) = 
\int\frac{1}{R}\rho\left(\vec{r}^\op, t - \frac{R}{c}\right)dv^\op
 + \varphi_0(r, t),
\end{equation}
where $\varphi_0(r, t)$ is the solution of the homogeneous equation and 
represents the contribution of the `external' charges and currents. The 
complete solution of equation \eqref{c8e4} is, likewise,
\begin{equation}\label{c8e14}
\vec{A}(\vec{r}, t) = 
\int\frac{1}{R}\vec{J}\left(\vec{r}^\op, t - \frac{R}{c}\right)dv^\op
 + \vec{A}_0(r, t).
\end{equation}

\item We now apply the ideas of the previous section to find the potentials
due to a charged particle moving along an arbitrary trajectory $\vec{r}_s(t)$,
where the subecript `s' stands for the source of the fields. Let the fields be
measured at a point $\vec{r}$ at time $t$. Since light travels at a finite 
speed, the field at $\vec{r}$ at time $t$ will depend on the source as it was
a time when light from it started and reached the field point at $t$. If 
\begin{equation}\label{c8e15}
\vec{R}(t) = \vec{r} - \vec{r}_s(t)
\end{equation}
then the fields at time $t$ will depend on the sources at a time $t_r < t$ 
given by
\begin{equation}\label{c8e16}
t_r + \frac{R(t_r)}{c} = t.
\end{equation}
This equation suggests that $t_r$ is really an implicit function of $R$ and $t$.
It is called the \emph{retarded time}.

In the frame of reference in which the charged particle is at rest at time
$t_rt$ the potentials at the field point are
\begin{equation}\label{c8e17}
\varphi(\vec{r}, t) = \frac{q}{R(t_r)}, \vec{A}(\vec{r}, t) = 0.
\end{equation}
Note that we are not saying $t = t_r$. In this frame, we can only calculate the
potential at the field point at a future time $t = t_r + R(t_r)/c$.

Using \eqref{c8e16} we can write $R(t_r)$ as
\begin{equation}\label{c8e18}
\varphi(\vec{r}, t)=\frac{q}{c(t - t_r)}=q\frac{\gamma c}{c(t - t_r)(\gamma c)}.
\end{equation}
The purpose for the $\gamma c$ factor in numerator and denominator is to give
us the hint that the expression $v^\mu/(R_\mu v^\mu)$ will be the correct
covariant generalisation of $1/(c(t - t_r)$. Thus, we claim that the 4-potential
due to the charged particle in an arbitrary inertial frame of reference is
\begin{equation}\label{c8e19}
A^\mu = q\frac{v^\mu}{R_\mu v^\mu},
\end{equation}
where
\begin{equation}\label{c8e20}
v^\mu = \gamma(c, \vec{v})
\end{equation}
is the 4-velocity of the particle and
\begin{equation}\label{c8e21}
R^\mu = (c(t - t_r), \vec{R}).
\end{equation}
In the frame of reference in which the charged particle is momentarily at rest,
the 4-velocity is $v^\mu = \gamma(c, 0)$ and \eqref{c8e19} reduces to the pair
\eqref{c8e18}. Since 
\[
R_\mu v^\mu = \gamma(c^2(t - t_r) - \vec{R}\cdot\vec{v}) = \gamma c(c(t-t_r) 
- \vec{R}\cdot\vec{\beta}) = \gamma c(R - \vec{R}\cdot\vec{\beta}),
\]
we can write \eqref{c8e18} in the more familiar form
\begin{eqnarray}
\varphi(\vec{r}, t) &=& \frac{q}{R - \vec{R}\cdot\vec{\beta}} \label{c8e22} \\
\vec{A}(\vec{r}, t) &=& \frac{q\vec{\beta}}{R - \vec{R}\cdot\vec{\beta}}.
\label{c8e23}
\end{eqnarray}
We also note that
\begin{equation}\label{c8e24}
\vec{A}(\vec{r}, t) = \vec{\beta}\varphi(\vec{r}, t).
\end{equation}
The quantities $R$ and $\vec{\beta}$ on the rhs of \eqref{c8e22} and 
\eqref{c8e23} are calculated at time $t_r$. The potential in \eqref{c8e19} and
equivalently in \eqref{c8e22} and \eqref{c8e23} are called 
\emph{Lienard-Wiechart potentials}.

\item In order to compute the electric and magnetic fields due to the moving
charge from the Lienard-Wiechart potentials, we need a derivatives of $t_r$ and
$R$. We start with the derivative of $t_r$ with respect to $t$. $t_r$ is 
implicitly defined as a function or $\vec{r}$ and $t$ in \eqref{c8e16}. We
differentiate it with respect to $t$ to get
\begin{eqnarray*}
\td{t_r}{t} + \frac{1}{c}\td{R}{t} &=& 1 \\
\td{t_r}{t} + \frac{1}{c}\td{R}{t_r}\td{t_r}{t} &=& 1.
\end{eqnarray*}
Now, $R = |\vec{r} - \vec{r}_s(t_r)| = \sqrt{r^2-2\vec{r}\cdot\vec{r}_s+r_s^2}$
so that
\[
\td{R}{t_r} = \frac{1}{2R}\left(-2\vec{r}\cdot\vec{v} + \td{r_s^2}{t}\right).
\]
Since $r_s^2 = \vec{r}_s\cdot\vec{r}_s$, the last term on rhs is $2\vec{r}_s
\cdot\vec{v}$. Here, the derivative of $\vec{r}_s$ with respect to $t$ is the
velocity $\vec{v}$ of the charged particle. Therefore,
\[
\td{R}{t_r} = \frac{-1}{2R}2(\vec{r} - \vec{r}_s)\cdot\vec{v} = 
-\frac{\vec{R}\cdot\vec{v}}{R}.
\]
and hence
\[
\td{t_r}{t} - \frac{\vec{R}\cdot\vec{\beta}}{R}\td{t_r}{t} = 1
\]
leading to
\begin{equation}\label{c8e25}
\td{t_r}{t} = \frac{1}{1 - \un_s\cdot\vec{\beta}},
\end{equation}
where
\begin{equation}\label{c8e26}
\un_s = \frac{\vec{R}}{R}
\end{equation}
is the unit vector along $\vec{R}$.

\item Taking the gradient of equation \eqref{c8e16}, we get
\begin{equation}\label{c8e27}
\grad t_r + \frac{1}{c}\grad R(t_r) = 0.
\end{equation}
Now,
\begin{eqnarray*}
\grad R &=& \hat{e}_i\frac{\partial}{\partial x_i}|\vec{r} - \vec{r}_s| \\
 &=& \frac{\hat{e}_i}{2|\vec{r}-\vec{r}_s|}\frac{\partial}{\partial x_i}
 [(x_j - x_{sj})(x_j - x_{sj})] \\
 &=& \frac{\hat{e}_i}{2|\vec{r}-\vec{r}_s|}2(x_j - x_{sj})
 \frac{\partial}{\partial x_i}(x_j - x_{sj}) \\
 &=& \frac{\hat{e}_i(x_j - x_{sj})}{|\vec{r}-\vec{r}_s|}\left(\delta_{ij} - 
 \pdt{x_{sj}}{x_i}\right) \\
 &=& \frac{\hat{e}_i(x_j - x_{sj})}{|\vec{r}-\vec{r}_s|}\left(\delta_{ij} - 
 \pdt{x_{sj}}{t_r}\pdt{t_r}{x_i}\right) \\
 &=& \un_s - \frac{1}{|\vec{r} - \vec{r}_s|}\left\{(x_j - x_{sj})v_j\right\}
 \left\{\hat{e}_i\pdt{t_r}{x_i}\right\} \\
 &=& \un_s - \frac{(\vec{r} - \vec{r}_s)\cdot\vec{v}}{|\vec{r} - \vec{r}_s|}
 \grad t_r \\
 &=& \un_s - \un_s\cdot\vec{v} \grad t_r.
\end{eqnarray*}
Substituting this in equation \eqref{c8e27} gives
\begin{equation}\label{c8e28}
\grad t_r = -\frac{\un_s}{c(1 - \un_s\cdot\vec{\beta})}.
\end{equation}
From equation \eqref{c8e27} we also have $\grad R(t_r) = -c\grad t_r$ so that
\begin{equation}\label{c8e29}
\grad R(t_r) = \frac{\un_s}{1 - \un_s\cdot\vec{\beta}}.
\end{equation}


\item We also have
\[
\td{R}{t_r} = \frac{d}{dt}|\vec{r} - \vec{r}_s| = 
\frac{d}{dt}\sqrt{(\vec{r} - \vec{r}_s)\cdot(\vec{r} - \vec{r}_s)}
= \frac{\vec{r} - \vec{r}_s}{|\vec{r} - \vec{r}_s|}\cdot(-\vec{v})
= -\un_s\cdot\vec{v}
\]
so that
\[
\td{R}{t} = \td{R}{t_r}\td{t_r}{t}
\]
gives
\begin{equation}\label{c8e30}
\td{R}{t} = -\frac{\un_s\cdot\vec{v}}{(1 - \un_s\cdot\vec{\beta})}
\end{equation}
where we used \eqref{c8e25} for $dt_r/dt$.

\item We will summarise all the derivatives we have found so far, calculate a 
few more and introduce symbols to ease calculation of fields. The factor $R - 
\vec{\beta}\cdot\vec{R}$ appears quite often. Using \eqref{c8e26} we can write
it as $S = RK$. Thus,
\begin{subequations}
\begin{eqnarray}
S &=& R - \vec{R}\cdot\vec{\beta} = RK \label{c8e31a} \\
K &=& 1 - \un_s\cdot\vec{\beta} \label{c8e31b}
\end{eqnarray}
\end{subequations}
Therefore,
\begin{subequations}
\begin{eqnarray}
\pdt{t_r}{t} &=& \frac{1}{K} \label{c8e32a} \\
\pdt{\vec{R}}{t} &=& -\frac{\vec{v}}{K} \label{c8e32b} \\
\pdt{R}{t} &=& -\frac{\un_s\cdot\vec{v}}{K} \label{c8e32c} \\
\pdt{\un_s}{t} &=& \frac{\un(\un\cdot\vec{v}) - \vec{n}}{RK} \label{c8e32d} \\
\pdt{\vec{\beta}}{t} &=& \frac{\vec{a}}{cK} \label{c8e32e} \\
\pdt{S}{t} &=& \frac{-c\un\cdot\vec{v} + v^2 - \vec{R}\cdot\vec{a}}{cK}
\label{c8e32f} \\
\grad t_r &=& -\frac{\un_s}{cK} \label{c8e32g} \\
\grad R &=& -\frac{\un_s}{K} \label{c8e32h} 
\end{eqnarray}
\end{subequations}
Here 
\[
\vec{a} = \td{\vec{v}}{t_r}
\]
is the accelaration of the particle. If dot denotes the derivative with respect
to $t_r$ then $\vec{a} = \dot{\vec{v}} = \dot{\vec{\beta}}/c.$

\item We will test these derivatives by checking whether the Lorenz gauge 
condition holds good.
Since $\varphi = q/S$,
\[
\pdt{\varphi}{t} = \frac{1}{K}\pdt{\varphi}{t_r} = -\frac{q}{KS^2}\pdt{S}{t_r}
= -\frac{q}{KS^2}\left(\pdt{R}{t_r} - \vec{R}\cdot\pdt{\vec{\beta}}{t_r} - 
\pdt{\vec{R}}{t_r}\cdot\vec{\beta}\right)
\]
Substituting for the derivatives,
\[
\pdt{\varphi}{t} = -\frac{q}{R^2K^3}\left(-\vec{n}_s\cdot\vec{v} - 
\frac{\vec{R}\cdot\vec{a}}{c} + \vec{v}\cdot\vec{\beta}\right)
\]
and hence
\begin{equation}\label{c8e33}
\frac{1}{c}\pdt{\varphi}{t} = -\frac{q}{R^2K^3}\left(-\vec{n}_s\cdot\vec{\beta}
+ \beta^2 - \frac{\vec{R}\cdot\dot{\vec{\beta}}}{c}\right).
\end{equation}

Since $\vec{A} = q\vec{\beta}/S$, 
\[
\dive\vec{A} = -\frac{q}{S^2}\left(\grad{S}\cdot\vec{\beta} - S\dive\vec{\beta}
\right).
\]
Now,
\[
\dive\vec{\beta} = \pdt{\beta_i}{x_i} = \pdt{\beta_i}{t_r}\pdt{t_r}{x_i} =
\grad{t_r}\cdot\dot{\vec{\beta}} = -\frac{\un_s\cdot\dot{\vec{\beta}}}{cK}
\]
so that
\[
\dive\vec{A} = -\frac{q}{S^2}\left(\grad{S}\cdot\vec{\beta} +
\frac{S}{cK}\un_s\cdot\dot{\vec{\beta}}\right).
\]
The calculation of $\grad S$ is a little tricky. Since $S = R - \vec{R}\cdot
\vec{\beta}$, $\grad S = \grad R - \grad(\vec{R}\cdot\vec{\beta})$. Using
\eqref{c8e32h}, we get
\begin{equation}\label{c8e34}
\grad S = \frac{\un_s}{K} - \grad((\vec{r} - \vec{r}_s)\cdot\vec{\beta})
= \frac{\un_s}{K} - \grad(\vec{r}\cdot\vec{\beta}) + \grad(\vec{r}_s\cdot
\vec{\beta})
\end{equation}
The second term on the rhs is
\[
\grad(\vec{r}\cdot\vec{\beta}) = \hat{e}_j\frac{\partial}{\partial x_j}
(x_i\beta_i) = \hat{e}_j\left(\delta_{ij}\beta_i + x_i\pdt{\beta_i}{t_r}
\pdt{t_r}{x_i}\right)
\]
so that
\begin{equation}\label{c8e35}
\grad(\vec{r}\cdot\vec{\beta}) = \vec{\beta} + (\vec{r}\cdot\dot{\vec{\beta}})
\grad t_r = \vec{\beta} - \frac{\un_s}{cK}(\vec{r}\cdot\dot{\vec{\beta}}).
\end{equation}
The third term on the rhs of \eqref{c8e34} is a gradient of a function of 
$\vec{r}_s$ alone so that we can write it as
\begin{equation}\label{c8e36}
\grad(\vec{r}_s\cdot\vec{\beta}) = \grad t_r \frac{d}{dt_r}(\vec{r}_s\cdot
\vec{\beta}) = -\frac{\un_s}{cK}(\vec{v}\cdot\vec{\beta} + \vec{r}_s\cdot
\dot{\vec{\beta}}).
\end{equation}
Substituting \eqref{c8e36} and \eqref{c8e35} in \eqref{c8e34}, we get
\[
\grad{S} = \frac{\un_s}{K} - \vec{\beta} + \frac{\un_s}{cK}(\vec{r} - \vec{r}_s)
\cdot\dot{\vec{\beta}} - \frac{\un_s}{K}\beta^2
\]
so that
\begin{equation}\label{c8e37}
\grad{S} = \frac{\un_s}{K} - \vec{\beta} + 
\frac{\un_s}{cK}\vec{R} \cdot\dot{\vec{\beta}} - \frac{\un_s}{K}\beta^2
\end{equation}
Putting everything together,
\begin{eqnarray*}
\dive\vec{A} &=& -\frac{q}{S^2}\left(\frac{\un_s\cdot\vec{\beta}}{K} - \beta^2
+ \frac{\un_s\cdot\vec{\beta}}{cK}\vec{R}\cdot\dot{\vec{\beta}} - 
\frac{\un_s\cdot\vec{\beta}}{K}\beta^2 + \frac{S}{cK}\un_s\cdot\dot{\vec{\beta}}
\right) \\
 &=& -\frac{q}{S^2}\left(\frac{\un_s\cdot\vec{\beta}}{K} - \frac{\beta^2}{K}
 + \frac{\vec{R}\cdot\vec{\beta}}{cK}\un_s\cdot\dot{\vec{\beta}} + 
 \frac{S}{cK}\un_s\cdot\dot{\vec{\beta}} \right) \\
 &=& -\frac{q}{S^2}\left(\frac{\un_s\cdot\vec{\beta}}{K} - \frac{\beta^2}{K}
 + \frac{R}{cK}\un_s\cdot\dot{\vec{\beta}} \right) \\
 &=& -\frac{q}{S^2}\left(\frac{\un_s\cdot\vec{\beta}}{K} - \frac{\beta^2}{K}
 + \frac{\vec{R}\cdot\dot{\vec{\beta}}}{cK}\right) 
\end{eqnarray*}
or
\begin{equation}\label{c8e38}
\dive\vec{A} = -\frac{q}{S^2K}\left(\un_s\cdot\vec{\beta} - \beta^2 +
\frac{\vec{R}\cdot\dot{\vec{\beta}}}{c}\right).
\end{equation}
From equations \eqref{c8e33} and \eqref{c8e38} one confirms that
\[
\frac{1}{c}\pdt{\varphi}{t} = -\dive\vec{A},
\]
which is just the Lorenz gauge condition.

\item We next calculate the electric field. Since $\varphi = q/S$,
\[
\grad\varphi = -\frac{q}{S^2}\grad S.
\]
From \eqref{c8e37},
\begin{equation}\label{c8e39}
-\grad\varphi = \frac{q}{S^2}\left(\frac{\un_s}{K} - \vec{\beta} + 
\frac{\vec{R}\cdot\dot{\vec{\beta}}}{cK} - \frac{\un_s}{K}\beta^2\right)
\end{equation}
Since $\vec{A} = q\vec{\beta}/S$,
\[
\pdt{\vec{A}}{t} = \frac{1}{K}\pdt{\vec{A}}{t_r} = 
-\frac{q}{S^2}\pdt{S}{t_r}\vec{\beta} + \frac{q}{SK}\dot{\vec{\beta}}
\]
so that
\begin{equation}\label{c8e40}
\vec{E} = \frac{q}{S^2K}\left[
\un_s\left(1 - \beta^2 + \frac{\vec{R}\cdot\dot{\vec{\beta}}}{c}\right) +
\vec{\beta}\left(\beta^2 - \un_s\cdot\vec{\beta} - 
    \frac{\vec{R}\cdot\dot{\vec{\beta}}}{c} - K\right) - 
\frac{RK}{c}\dot{\vec{\beta}}\right]
\end{equation}
Using the relations $\vec{R} = R\un_s, K = (1 - \un_s\cdot\vec{\beta}), S = RK$
we can transform the above equation as
\begin{eqnarray*}
\vec{E} &=& \frac{q}{R^2K^3}\left[\frac{\vec{R}}{R} - \frac{\vec{R}\beta^2}{R}
 + \frac{\vec{R}(\vec{R}\cdot\dot{\vec{\beta}})}{Rc} 
 + \beta^2\vec{\beta} - \right.\\
 & & \left.\frac{(\vec{R}\cdot\vec{\beta})\vec{\beta}}{R} - 
     \frac{(\vec{R}\cdot\dot{\vec{\beta}})\vec{\beta}}{c} - 
     \frac{(R - \vec{R}\cdot\vec{\beta})\vec{\beta}}{R} - 
     \frac{(R - \vec{R}\cdot\vec{\beta})\dot{\vec{\beta}}}{c}\right]
\end{eqnarray*}
The terms $(\vec{R}\cdot\vec{\beta})\vec{\beta}/R$ cancel and we combine 
\begin{eqnarray*}
\frac{\vec{R}(\vec{R}\cdot\dot{\vec{\beta}})}{Rc} - 
\frac{R^2\dot{\vec{\beta}}}{Rc} &=& 
\frac{\vec{R}\times(\vec{R}\times\dot{\vec{\beta}})}{Rc} \\
\frac{(\vec{R}\cdot\vec{\beta})\dot{\vec{\beta}}}{c} - 
\frac{(\vec{R}\cdot\dot{\vec{\beta}})\vec{\beta}}{c} &=&
\frac{\vec{R}\times(\dot{\vec{\beta}}\times\vec{\beta})}{c}
\end{eqnarray*}
to get
\[
\vec{E} = \frac{q}{R^2K^3}\left[\vec{R}{R} - \frac{\vec{R}\beta^2}{R} -
\beta^2\vec{\beta} - \vec{\beta} + 
\frac{\vec{R}\times(\vec{R}\times\dot{\vec{\beta})}}{Rc} + 
\frac{\vec{R}\times(\dot{\vec{\beta}}\times\vec{\beta})}{c}\right]
\]
so that we finally get
\begin{equation}\label{c8e41}
\vec{E} = \frac{q}{R^2K^3}\left\{\frac{(1-\beta^2)(\vec{R}-\vec{\beta}R)}{R} +
\frac{\vec{R}\times[(\vec{R} - \vec{\beta}R)\times\dot{\vec{\beta}}]}{Rc}
\right\}
\end{equation}

\item We will now calculate the magnetic field. Since $\vec{A} = q\beta/S$,
\[
\curl\vec{A} = -\frac{q}{S^2}\grad S \times \vec{\beta} + 
\frac{q}{S}\curl\vec{\beta},
\]
which, upon using \eqref{c8e37}, leads to
\begin{equation}\label{c8e42}
\vec{H} = \frac{q}{R^2K^3}(\un_s\times\vec{\beta})
\left(\beta^2 - 1 - \frac{\vec{R}\cdot\dot{\vec{\beta}}}{c}\right) -
\frac{q}{RK^2}\left(\un_s \times \frac{\dot{\vec{\beta}}}{c}\right)
\end{equation}
where we used the relation
\[
\curl\dot{\vec{\beta}} = \hat{e}_i\pdt{\dot{\beta}_k}{x_j} =
\hat{e}_i\pdt{t_r}{x_j}\pdt{\dot{\beta}_k}{t_r} = 
\grad{t_r}\times\dot{\vec{\beta}}.
\]
Since $K = 1 - \un_s\cdot\vec{\beta}$, we can simplify \eqref{c8e40} as
\[
\vec{E} = \frac{q}{S^2K}\left[
\un_s\left(1 - \beta^2 + \frac{\vec{R}\cdot\dot{\vec{\beta}}}{c}\right) +
\vec{\beta}\left(\beta^2 - 1 - \frac{\vec{R}\cdot\dot{\vec{\beta}}}{c}\right)- 
\frac{RK}{c}\dot{\vec{\beta}}\right]
\]
so that
\[
\un_s \times \vec{E} = \frac{q}{R^2K^3}\left[
\left(\beta^2 - 1 - \frac{\vec{R}\cdot\dot{\vec{\beta}}}{c}\right)
(\un\times\vec{\beta}) - \frac{RK}{c}(\un\times\dot{\vec{\beta}})\right].
\]
Comparing this with \eqref{c8e42} gives
\begin{equation}\label{c8e43}
\vec{H} = \un_s \times \vec{E}.
\end{equation}

\item Of the two terms in \eqref{c8e41}, the first term depends on velocity
and the second one on acceleration. For large $R$, the first term vanishes as
$1/R^2$ while the second one as $1/R$. We will see in the next chapter that the
second one is related to radiation by accelerated charges. 

\item I did not find anything noteworthy in the section on the spectral
resolution of the retarded potentials.

\item In classical mechanics, the Lagrangian of a system of particles is a 
function of the positions and velocities of the particles. This form implicity
assumes that the change in the position and velocity of one particle affects 
all others instantaneously. Therefore, this form of the Lagrangian is not fully
correct in the classical theory of fields. The Lagrangian must include at the
degrees of freedom of the field as well.

\item We will develop a fully rigorous classical Lagrangian later. For now, we
will enchance the form we wrote in classical mechanics to include 
electromagnetic interactions when the particles move at speeds small as compared
to $c$. The Lagrangian for a charged particle in an electromagnetic field 
described by $A^\mu = (\varphi, \vec{A})$ is given by \eqref{c3e6} as 
\[
L = mc^2\sqrt{1 - \beta^2} - q\varphi - \frac{q}{c}\vec{A}\cdot\vec{v}.
\]
In an assembly of charged particles, the Lagrangian of a single particle with
charge $q_a$ due to all others is of the same form,
\begin{equation}\label{c8e44}
L_a = m_ac^2\sqrt{1 - \beta_a^2} - q_a\varphi - 
\frac{q_a}{c}\vec{A}\cdot\vec{v_a}.
\end{equation}
Let us assume that there are no `external' charges and currents so that we can
drop the second term on the rhs of \eqref{c8e13} and \eqref{c8e14} and hence
\begin{eqnarray*}
\varphi(\vec{r}, t) &=& \int\frac{1}{R}\rho
\left(\vec{r}^\op, t - \frac{R}{c}\right)dV^\op \\
\vec{A}(\vec{r}, t) &=& \int\frac{1}{R}\vec{J}
\left(\vec{r}^\op, t - \frac{R}{c}\right)dV^\op 
\end{eqnarray*}
If the speed of particles is small as compared to $c$, they do not move 
significantly in the it takes for light to travel from their position to where
$q_a$ is. We, therefore, expand the integrands in the above equations about
$t$ and ignore terms in cubic and higher powers in $1/c$. Starting with the
scalar potential,
\[
\rho\left(\vec{r}^\op, t - \frac{R}{c}\right) = \rho(\vec{r}^\op) -
\frac{R}{c}\pdt{\rho}{t} + \frac{R^2}{c^2}\spdt{\rho}{t}
\]
so that
\begin{eqnarray*}
\varphi(\vec{r}, t) &=& \int\frac{\rho(\vec{r}^\op)}{R}dV^\op - \frac{1}{c}
\frac{\partial}{\partial t}\int\rho(\vec{r}^\op)dV^\op + \frac{1}{c^2}
\frac{\partial^2}{\partial t^2}\int R\rho(\vec{r}^\op)dV^\op \\
\vec{A}(\vec{r}, t) &=& \frac{1}{c}\int\frac{\vec{J}(\vec{r}^\op)}{R}dV^\op - 
\frac{1}{c^2}\frac{\partial}{\partial t}\int\vec{J}(\vec{r}^\op)dV^\op 
\end{eqnarray*}
Because of the overall factor $1/c$ in the expression for $\vec{A}$ we do not
go beyond the first derivative term on the rhs. For a localised charge 
distribution,
\[
\int\rho(\vec{r}^\op)dV^\op
\]
is the total charge. Since it is a constant, its time derivative is zero. As
a result, the second term in the rhs of $\varphi$ vanishes. This also means that
the net current in the region where the charges are is zero. That is,
\[
\int\vec{J}(\vec{r}^\op)dV^\op = 0.
\]
The expressions for the potentials simplify to
\begin{eqnarray}
\varphi(\vec{r}, t) &=& \int\frac{\rho(\vec{r}^\op)}{R}dV^\op + \frac{1}{c^2}
\frac{\partial^2}{\partial t^2}\int R\rho(\vec{r}^\op)dV^\op \label{c8e45} \\
\vec{A}(\vec{r}, t) &=& \frac{1}{c}\int\frac{\vec{J}(\vec{r}^\op)}{R}dV^\op
\label{c8e46}
\end{eqnarray}
For a point charge, these expressions become
\begin{eqnarray}
\varphi(\vec{r}, t) &=& \frac{q}{R} + \frac{q}{2c^2}\spdt{R}{t} \label{c8e47}\\
\vec{A}(\vec{r}, t) &=& \frac{q\vec{v}}{cR} \label{c8e48}
\end{eqnarray}
Introducing a gauge function
\begin{equation}\label{c8e49}
f = \frac{q}{2c}\pdt{R}{t},
\end{equation}
the potentials in \eqref{c8e47} and \eqref{c8e48} are equivalent to
\begin{eqnarray}
\varphi^\op &=& \varphi - \frac{1}{c}\pdt{f}{t} = \frac{q}{R} \label{c8e50} \\
\vec{A}^\op &=& \vec{A} - \grad{f} = \frac{q\vec{v}}{cR} + \frac{q}{2c}\grad
\pdt{R}{t} \label{c8e51}
\end{eqnarray}

Since
\[
\grad\pdt{R}{t} = \frac{\partial}{\partial t}\grad{R},
\]
we will start with evaluating $\grad R$. Recall that $\vec{R} = \vec{r} - 
\vec{r}^\op$ so that $R = |\vec{r} - \vec{r}^\op|$ and
\[
\grad R = \hat{e}_i\frac{\partial}{\partial x_i}
\sqrt{\sum_{j=1}^3(x_j - x_j^\op)^2} = 
\frac{\hat{e}_i}{2R}2(x_j-x_j^\op)\delta_{ij} = \frac{\vec{R}}{R} = \un,
\]
where $\un$ is the unit vector from the source point to the field point. Its
partial derivatibe with respect to time is
\[
\pdt{\un}{t} = \frac{\dot{\vec{R}}}{R} - \frac{\vec{R}\dot{R}}{R^2}.
\]
Note that the field point is fixed. $\vec{R}$ changes because the source point
moves. Therefore, $-\dot{\vec{R}}$ is the velocity $\vec{v}$ of the source 
point. Further more, since $R^2 = \vec{R}\cdot\vec{R}$, $2R\dot{R} = 2\vec{R}
\cdot\dot{\vec{R}}$ or $R\dot{R} = -\vec{R}\cdot\vec{v}$ so that
\begin{equation}\label{c8e52}
\pdt{\un}{t} = -\frac{\vec{v}}{R} + \frac{\vec{R}}{R^3}(\vec{R}\cdot\vec{v})
= \frac{\un(\un\cdot\vec{v}) - \vec{v}}{R}
\end{equation}
Therefore, \eqref{c8e51} can be written as
\begin{equation}\label{c8e53}
\vec{A}^\op = q\frac{\vec{v} + \un(\un\cdot\vec{v})}{2cR}.
\end{equation}

\item In an assembly of charges, the potentials felt by the charge $q_a$ are
\begin{eqnarray*}
\phi &=& \sum_{b \ne a} \frac{q_b}{R_{ab}} \\
\vec{A}&=&\sum_{b \ne a} 
q_b\frac{\vec{v}_b+\un_{ab}(\un_{ab}\cdot\vec{v}_b)}{2cR_{ab}}
\end{eqnarray*}
The Lagrangian \eqref{c8e41} becomes
\[
L_a = -m_ac^2\sqrt{1 - \beta_a^2} - \sum_{b \ne a}\frac{q_aq_b}{R_{ab}} - 
\sum_{b \ne a} \frac{q_aq_b}{2c^2R_{ab}}(\vec{v}_a\cdot\vec{v}_b + 
(\un_{ab}\cdot\vec{v}_a) (\un_{ab}\cdot\vec{v}_b))
\]
Up to quadratic order in $v/c$, the Lagrangian is
\begin{equation}\label{c8e54}
L_a = \frac{m_av_a^2}{2}+\frac{m_av_a^4}{8c^2}-\sum_{b \ne a}\frac{q_aq_b}{R_{ab}}- 
\sum_{b \ne a} \frac{q_aq_b}{2c^2R_{ab}}(\vec{v}_a\cdot\vec{v}_b + 
(\un_{ab}\cdot\vec{v}_a)(\un_{ab}\cdot\vec{v}_b))
\end{equation}
where we ignored the constant term $m_ac^2$. The Lagrangian for the entire 
assembly is
\begin{eqnarray*}
L &=& \sum_a\frac{m_av_a^2}{2} + \sum_a\frac{m_av_a^4}{8c^2} - \nonumber \\
 & & \sum_{ab, b \ne a}\frac{q_aq_b}{2R_{ab}} -  
\sum_{ab, b \ne a} \frac{q_aq_b}{4c^2R_{ab}}(\vec{v}_a\cdot\vec{v}_b + 
(\un_{ab}\cdot\vec{v}_a)(\un_{ab}\cdot\vec{v}_b)).\label{c8e55}
\end{eqnarray*}
We introduced a factor of $1/2$ in the sums over $a$ and $b$ to avoid double
counting. Thus, the Lagrangian of the entire system is not the sum of the 
Lagrangians of the individual particles. The expression of \eqref{c8e55} is 
called the Darwin Lagrangian.

\item The Hamiltonian of the system is
\begin{eqnarray*}
H &=& \sum_a\frac{p_a^2}{2m_a} + \sum_a\frac{p_a^4}{8c^2m_a^3} - \nonumber \\
 & & \sum_{ab, b \ne a}\frac{q_aq_b}{2R_{ab}} -  
\sum_{ab, b \ne a} \frac{q_aq_b}{4c^2m_am_bR_{ab}}(\vec{p}_a\cdot\vec{p}_b + 
(\un_{ab}\cdot\vec{p_a})(\un_{ab}\cdot\vec{p_b})).\label{c8e55}
\end{eqnarray*}
Since the Hamiltonian of the assembly is not the sum of Hamiltonians of the
constituent particles, the system is not extensive and the usual techniques of
thermodynamics cannot be applied without due care.
\end{enumerate}
